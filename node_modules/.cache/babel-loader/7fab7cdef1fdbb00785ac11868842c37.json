{"ast":null,"code":"import _regeneratorRuntime from \"/Users/will/Documents/beader.org/react/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/will/Documents/beader.org/react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/will/Documents/beader.org/react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/will/Documents/beader.org/react/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/will/Documents/beader.org/react/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/will/Documents/beader.org/react/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/will/Documents/beader.org/react/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/will/Documents/beader.org/react/src/components/Patterns.js\";\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport queryString from 'query-string';\nimport api from '../api';\nimport { titleSuffix } from '../config';\nimport LoadingIndicator from './LoadingIndicator';\n\nvar Patterns =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Patterns, _Component);\n\n  function Patterns() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Patterns);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Patterns)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      patterns: [],\n      page: undefined,\n      search: undefined,\n      limit: 20,\n      showNext: false,\n      showPrevious: false,\n      loading: true\n    };\n    return _this;\n  }\n\n  _createClass(Patterns, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetch();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (prevProps.location.search !== this.props.location.search) {\n        window.scrollTo({\n          top: 0\n        });\n        this.fetch();\n      }\n    }\n  }, {\n    key: \"fetch\",\n    value: function () {\n      var _fetch = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var query, url, response;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                query = queryString.parse(this.props.location.search);\n                this.setState({\n                  page: query.page ? parseInt(query.page, 10) : 1,\n                  search: query.search\n                });\n                url = \"/patterns?page=\".concat(this.state.page, \"&limit=\").concat(this.state.limit);\n\n                if (this.state.search) {\n                  url += \"&search=\".concat(this.state.search);\n                }\n\n                this.setState({\n                  loading: true\n                });\n                _context.next = 7;\n                return api.get(url);\n\n              case 7:\n                response = _context.sent;\n                document.title = \"Page \".concat(this.state.page).concat(titleSuffix);\n                this.setState({\n                  patterns: response.patterns,\n                  showPrevious: page > 1,\n                  showNext: page < response.totalPages,\n                  loading: false\n                });\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function fetch() {\n        return _fetch.apply(this, arguments);\n      }\n\n      return fetch;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          patterns = _this$state.patterns,\n          showPrevious = _this$state.showPrevious,\n          showNext = _this$state.showNext,\n          loading = _this$state.loading,\n          page = _this$state.page;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }, React.createElement(LoadingIndicator, {\n        loading: loading,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      }), !loading && patterns.length > 0 && React.createElement(\"div\", {\n        className: \"pattern-tiles-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      }, patterns.map(function (pattern) {\n        return React.createElement(\"div\", {\n          key: pattern._id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 68\n          },\n          __self: this\n        }, React.createElement(Link, {\n          to: \"/pattern/\".concat(pattern._id),\n          className: \"pattern-tile\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: \"\".concat(pattern.imageUrl.replace('/upload', '/upload/c_thumb,w_150,h_150')),\n          alt: pattern.name,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 70\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          className: \"pattern-tile-meta\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 71\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"pattern-tile-name\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72\n          },\n          __self: this\n        }, pattern.name), React.createElement(\"div\", {\n          className: \"pattern-tile-user\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 73\n          },\n          __self: this\n        }, \"by \", pattern.user.displayName))));\n      })), !loading && patterns.length === 0 && React.createElement(\"div\", {\n        className: \"not-found\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }, \"No patterns found\"), React.createElement(\"div\", {\n        className: \"pagination footer-navigation\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, showPrevious && React.createElement(Link, {\n        to: \"/patterns?page=\".concat(page - 1, \"&search=\").concat(this.state.search),\n        className: \"footer-link previous\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, \"Previous Page\"), showNext && React.createElement(Link, {\n        to: \"/patterns?page=\".concat(page + 1, \"&search=\").concat(this.state.search),\n        className: \"footer-link next\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, \"Next Page\")), React.createElement(\"div\", {\n        className: \"footer-ads\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Patterns;\n}(Component);\n\nexport default Patterns;","map":{"version":3,"sources":["/Users/will/Documents/beader.org/react/src/components/Patterns.js"],"names":["React","Component","Link","queryString","api","titleSuffix","LoadingIndicator","Patterns","state","patterns","page","undefined","search","limit","showNext","showPrevious","loading","fetch","prevProps","prevState","location","props","window","scrollTo","top","query","parse","setState","parseInt","url","get","response","document","title","totalPages","length","map","pattern","_id","imageUrl","replace","name","user","displayName"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport queryString  from 'query-string';\n\nimport api from '../api';\nimport { titleSuffix } from '../config';\nimport LoadingIndicator from './LoadingIndicator';\n\nclass Patterns extends Component {\n  state = {\n    patterns: [],\n    page: undefined,\n    search: undefined,\n    limit: 20,\n    showNext: false,\n    showPrevious: false,\n    loading: true,\n  }\n\n  componentDidMount() {\n    this.fetch();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if(prevProps.location.search !== this.props.location.search) {\n      window.scrollTo({top: 0});\n      this.fetch();\n    }\n  }\n\n  async fetch() {\n    const query = queryString.parse(this.props.location.search);\n    this.setState({\n      page: query.page ? parseInt(query.page, 10) : 1,\n      search: query.search\n    });\n\n    let url = `/patterns?page=${this.state.page}&limit=${this.state.limit}`;\n\n    if (this.state.search) {\n      url += `&search=${this.state.search}`;\n    }\n\n    this.setState({loading: true});\n\n    const response = await api.get(url);\n\n    document.title = `Page ${this.state.page}${titleSuffix}`;\n\n    this.setState({\n      patterns: response.patterns,\n      showPrevious: page > 1,\n      showNext: page < response.totalPages,\n      loading: false,\n    });\n  }\n\n  render() {\n    const { patterns, showPrevious, showNext, loading, page } = this.state;\n\n    return (\n      <div>\n        <LoadingIndicator loading={loading}></LoadingIndicator>\n\n        {!loading && patterns.length > 0 &&\n          <div className=\"pattern-tiles-container\">\n            {patterns.map(pattern => (\n              <div key={pattern._id}>\n                <Link to={`/pattern/${pattern._id}`} className='pattern-tile'>\n                  <img src={`${pattern.imageUrl.replace('/upload', '/upload/c_thumb,w_150,h_150')}`} alt={pattern.name}/>\n                  <div className=\"pattern-tile-meta\">\n                    <div className=\"pattern-tile-name\">{pattern.name}</div>\n                    <div className=\"pattern-tile-user\">by {pattern.user.displayName}</div>\n                  </div>\n                </Link>\n              </div>\n            ))}\n          </div>\n        }\n\n        {!loading && patterns.length === 0 &&\n          <div className=\"not-found\">No patterns found</div>\n        }\n\n        <div className=\"pagination footer-navigation\">\n          {showPrevious && <Link to={`/patterns?page=${page - 1}&search=${this.state.search}`} className='footer-link previous'>Previous Page</Link>}\n          {showNext && <Link to={`/patterns?page=${page + 1}&search=${this.state.search}`} className='footer-link next'>Next Page</Link>}\n        </div>\n\n        <div className=\"footer-ads\">\n          {/* <script async src=\"//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js\"></script>\n          <ins class=\"adsbygoogle\"\n              style=\"display:block\"\n              data-ad-client=\"ca-pub-5755919955683762\"\n              data-ad-slot=\"9668770775\"\n              data-ad-format=\"auto\"></ins>\n          <script>\n          (adsbygoogle = window.adsbygoogle || []).push({});\n          </script> */}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Patterns;\n"]},"metadata":{},"sourceType":"module"}